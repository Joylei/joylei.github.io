<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    <!-- Enable responsiveness on mobile devices-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <title>Lei&#x27;s Blog - 编写NLog飞信扩展</title>

    
    <link rel="alternate"
        type="application/atom+xml"
        title="RSS" href="https://blog.dotone.top/atom.xml">
    

    <script defer src="https://blog.dotone.top/vendor/instant.page-5.1.0.js" type="module"></script>
    <script defer src="https://blog.dotone.top/vendor/medium-zoom.min.js"
        onload="mediumZoom(document.querySelectorAll('div.post-content img'), { background: '#f8f5f5'});">
    </script>
    <script defer src="https://blog.dotone.top/vendor/slideout-1.0.1.min.js"></script>
    

    <script defer src="https://blog.dotone.top/vendor/katex@0.10.0/katex.min.js">
    </script>
    <script defer src="https://blog.dotone.top/vendor/katex@0.10.0/mathtex-script-type.min.js">
    </script>
    
    <script defer src="https://blog.dotone.top/vendor/katex@0.10.0/auto-render.min.js"
        onload="renderMathInElement(document.body);"></script>
    
    

    
    
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-177611810-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-177611810-1');
</script>


    

    

    
    <link rel="stylesheet" href="https://blog.dotone.top/site.css">
    
    <link rel="stylesheet" href="https://blog.dotone.top/vendor/katex@0.10.0/katex.min.css">
    
    

    
    
</head>

<body>
    <div class="container">

        <div id="mobile-navbar" class="mobile-navbar">
            <div class="mobile-header-logo">
                <a href="/" class="logo">Lei&#x27;s Blog</a>
            </div>
            <div class="mobile-navbar-icon icon-out">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>

        <nav id="mobile-menu" class="mobile-menu slideout-menu slideout-menu-left" itemscope
            itemtype="http://schema.org/SiteNavigationElement">
            <ul class="mobile-menu-list">
                
                <li class="mobile-menu-item">
                    <a itemprop="url" href="https:&#x2F;&#x2F;blog.dotone.top">
                        <span itemprop="name">Home</span>
                    </a>
                </li>
                
                <li class="mobile-menu-item">
                    <a itemprop="url" href="https:&#x2F;&#x2F;blog.dotone.top&#x2F;categories">
                        <span itemprop="name">Categories</span>
                    </a>
                </li>
                
                <li class="mobile-menu-item">
                    <a itemprop="url" href="https:&#x2F;&#x2F;blog.dotone.top&#x2F;tags">
                        <span itemprop="name">Tags</span>
                    </a>
                </li>
                
                <li class="mobile-menu-item">
                    <a itemprop="url" href="https:&#x2F;&#x2F;blog.dotone.top&#x2F;about">
                        <span itemprop="name">About</span>
                    </a>
                </li>
                
            </ul>
        </nav>

        <header id="header">
            <div class="logo"><a href="https:&#x2F;&#x2F;blog.dotone.top">Lei&#x27;s Blog</a></div>
            <nav class="menu" itemscope itemtype="http://schema.org/SiteNavigationElement">
                <ul>
                    
                    <li>
                        <a itemprop="url" href="https:&#x2F;&#x2F;blog.dotone.top">
                            <span itemprop="name">Home</span>
                        </a>
                    </li>
                    
                    <li>
                        <a itemprop="url" href="https:&#x2F;&#x2F;blog.dotone.top&#x2F;categories">
                            <span itemprop="name">Categories</span>
                        </a>
                    </li>
                    
                    <li>
                        <a itemprop="url" href="https:&#x2F;&#x2F;blog.dotone.top&#x2F;tags">
                            <span itemprop="name">Tags</span>
                        </a>
                    </li>
                    
                    <li>
                        <a itemprop="url" href="https:&#x2F;&#x2F;blog.dotone.top&#x2F;about">
                            <span itemprop="name">About</span>
                        </a>
                    </li>
                    
                </ul>
            </nav>
        </header>

        <main>
            <div class="content" id="mobile-panel">
                


<div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">Contents</h2>
    <div class="post-toc-content always-active">
        <nav id="TableOfContents">
            <ul>
                
                <li>
                    <a href="https://blog.dotone.top/blog/it/nlog-target-fetion/#bian-xie-nlogkuo-zhan" class="toc-link">编写NLog扩展:</a>
                    
                </li>
                
                <li>
                    <a href="https://blog.dotone.top/blog/it/nlog-target-fetion/#xiang-guan-zi-yuan" class="toc-link">相关资源：</a>
                    
                </li>
                
            </ul>
        </nav>
    </div>
</div>


<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <h1 class="post__title" itemprop="headline">
        <a href="https:&#x2F;&#x2F;blog.dotone.top&#x2F;blog&#x2F;it&#x2F;nlog-target-fetion&#x2F;">编写NLog飞信扩展</a>
    </h1>
    
<div class="post__meta">
    <svg style="margin-bottom:-3px" class="i-clock" viewBox="0 0 32 32" width="16" height="16" fill="none"
        stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="6.25%">
        <circle cx="16" cy="16" r="14" />
        <path d="M16 8 L16 16 20 20" />
    </svg>
    <span>4 minute read</span>
    
    <svg style="margin-bottom: -3px" class="i-edit" viewBox="0 0 32 32" width="16" height="16" fill="none"
        stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="6.25%">
        <path d="M30 7 L25 2 5 22 3 29 10 27 Z M21 6 L26 11 Z M5 22 L10 27 Z" />
    </svg>
    <span class="post__time">Published: 2010-03-24</span>
    
    
</div>

    <div class="post-content" itemprop="articleBody">
        <p><code>NLog</code>是个功能很丰富的日志记录工具，我们可以很方便的扩展日志目标。当系统发生严重错误时，我们希望通过短信得到通知，用飞信<code>API(fetionlib)</code>写一个飞信扩展，就得到了免费的短信提醒。</p>
<h2 id="bian-xie-nlogkuo-zhan">编写NLog扩展:</h2>
<p>很简单，只需从<code>TargetWithLayout</code>继承，重写<code>Write</code>方法就行了。</p>
<p>FetionTarget.cs</p>
<pre data-lang="c#" style="background-color:#2b303b;color:#c0c5ce;" class="language-c# "><code class="language-c#" data-lang="c#"><span>
</span><span>    </span><span style="color:#b48ead;">using </span><span>System;
</span><span>    </span><span style="color:#b48ead;">using </span><span>System.Collections.Generic;
</span><span>    </span><span style="color:#b48ead;">using </span><span>System.Linq;
</span><span>    </span><span style="color:#b48ead;">using </span><span>System.Net;
</span><span>    </span><span style="color:#b48ead;">using </span><span>System.Net.Cache;
</span><span>    </span><span style="color:#b48ead;">using </span><span>System.Text;
</span><span>    </span><span style="color:#b48ead;">using </span><span>Newtonsoft.Json;
</span><span>    </span><span style="color:#b48ead;">using </span><span>System.IO;
</span><span>    </span><span style="color:#b48ead;">using </span><span>System.Text.RegularExpressions;
</span><span>    </span><span style="color:#b48ead;">using </span><span>System.Threading;
</span><span>    </span><span style="color:#b48ead;">using </span><span>System.Web;
</span><span>
</span><span>    </span><span style="color:#b48ead;">using </span><span>NLog;
</span><span>
</span><span>    </span><span style="color:#b48ead;">namespace </span><span>FetionLib
</span><span>    {
</span><span>        [</span><span style="color:#bf616a;">Target</span><span>(&quot;</span><span style="color:#a3be8c;">Fetion</span><span>&quot;)]
</span><span>        </span><span style="color:#b48ead;">public class </span><span style="color:#ebcb8b;">FetionTarget </span><span style="color:#eff1f5;">: </span><span style="color:#a3be8c;">TargetWithLayout
</span><span style="color:#eff1f5;">        {
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">public </span><span style="color:#8fa1b3;">FetionTarget</span><span style="color:#eff1f5;">()
</span><span style="color:#eff1f5;">            {
</span><span style="color:#eff1f5;">            }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#65737e;">/// &lt;</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// 基本地址
</span><span style="color:#65737e;">            /// &lt;/</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">public string </span><span style="color:#bf616a;">BaseAddress </span><span style="color:#eff1f5;">{ </span><span style="color:#b48ead;">get</span><span style="color:#eff1f5;">; </span><span style="color:#b48ead;">set</span><span style="color:#eff1f5;">; }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#65737e;">/// &lt;</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// 登录手机号
</span><span style="color:#65737e;">            /// &lt;/</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">public string </span><span style="color:#bf616a;">Mobile </span><span style="color:#eff1f5;">{ </span><span style="color:#b48ead;">get</span><span style="color:#eff1f5;">; </span><span style="color:#b48ead;">set</span><span style="color:#eff1f5;">; }
</span><span style="color:#eff1f5;">            </span><span style="color:#65737e;">/// &lt;</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// 用户密码
</span><span style="color:#65737e;">            /// &lt;/</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">public string </span><span style="color:#bf616a;">Password </span><span style="color:#eff1f5;">{ </span><span style="color:#b48ead;">get</span><span style="color:#eff1f5;">; </span><span style="color:#b48ead;">set</span><span style="color:#eff1f5;">; }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#65737e;">/// &lt;</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// 收信人
</span><span style="color:#65737e;">            /// &lt;/</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">public string </span><span style="color:#bf616a;">Recipients </span><span style="color:#eff1f5;">{ </span><span style="color:#b48ead;">get</span><span style="color:#eff1f5;">; </span><span style="color:#b48ead;">set</span><span style="color:#eff1f5;">; }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#65737e;">/// &lt;</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// 超时时限
</span><span style="color:#65737e;">            /// &lt;/</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">public string </span><span style="color:#bf616a;">Timeout </span><span style="color:#eff1f5;">{ </span><span style="color:#b48ead;">get</span><span style="color:#eff1f5;">; </span><span style="color:#b48ead;">set</span><span style="color:#eff1f5;">; }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#65737e;">/// &lt;</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// 缓存消息数量
</span><span style="color:#65737e;">            /// &lt;/</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">public int </span><span style="color:#bf616a;">BufferCount </span><span style="color:#eff1f5;">{ </span><span style="color:#b48ead;">get</span><span style="color:#eff1f5;">; </span><span style="color:#b48ead;">set</span><span style="color:#eff1f5;">; }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">protected override void </span><span style="color:#8fa1b3;">Write</span><span style="color:#eff1f5;">(LogEventInfo </span><span style="color:#bf616a;">logEvent</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">            {
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">string </span><span style="color:#bf616a;">message </span><span>= </span><span style="color:#bf616a;">CompiledLayout</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">GetFormattedMessage</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">logEvent</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#bf616a;">Send</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">message</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">            }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">protected override void </span><span style="color:#8fa1b3;">Write</span><span style="color:#eff1f5;">(LogEventInfo[] </span><span style="color:#bf616a;">logEvents</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">            {
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">foreach </span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">var </span><span style="color:#bf616a;">eventInfo </span><span style="color:#b48ead;">in </span><span style="color:#bf616a;">logEvents</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">                {
</span><span style="color:#eff1f5;">                    </span><span style="color:#bf616a;">Write</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">eventInfo</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                }
</span><span style="color:#eff1f5;">            }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#65737e;">/// &lt;</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// 发送消息
</span><span style="color:#65737e;">            /// &lt;/</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// &lt;</span><span style="color:#bf616a;">param </span><span style="color:#d08770;">name</span><span style="color:#65737e;">=</span><span style="color:#a3be8c;">&quot;message&quot;</span><span style="color:#65737e;">&gt;&lt;/</span><span style="color:#bf616a;">param</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// &lt;</span><span style="color:#bf616a;">returns</span><span style="color:#65737e;">&gt;&lt;/</span><span style="color:#bf616a;">returns</span><span style="color:#65737e;">&gt;
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">private void </span><span style="color:#8fa1b3;">Send</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">string </span><span style="color:#bf616a;">message</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">            {
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">if</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">string</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">IsNullOrEmpty</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">BaseAddress</span><span style="color:#eff1f5;">))
</span><span style="color:#eff1f5;">                {
</span><span style="color:#eff1f5;">                    </span><span style="color:#bf616a;">Console</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">WriteLine</span><span style="color:#eff1f5;">(</span><span>&quot;</span><span style="color:#a3be8c;">BaseAddress为空</span><span>&quot;</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                    </span><span style="color:#b48ead;">return</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">if </span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">string</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">IsNullOrEmpty</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">Mobile</span><span style="color:#eff1f5;">))
</span><span style="color:#eff1f5;">                {
</span><span style="color:#eff1f5;">                    </span><span style="color:#bf616a;">Console</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">WriteLine</span><span style="color:#eff1f5;">(</span><span>&quot;</span><span style="color:#a3be8c;">Mobile为空</span><span>&quot;</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                    </span><span style="color:#b48ead;">return</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">if </span><span style="color:#eff1f5;">(</span><span>!</span><span style="color:#bf616a;">Regex</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">IsMatch</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">Mobile</span><span style="color:#eff1f5;">, </span><span>@&quot;</span><span style="color:#a3be8c;">\d+</span><span>&quot;</span><span style="color:#eff1f5;">))
</span><span style="color:#eff1f5;">                {
</span><span style="color:#eff1f5;">                    </span><span style="color:#bf616a;">Console</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">WriteLine</span><span style="color:#eff1f5;">(</span><span>&quot;</span><span style="color:#a3be8c;">Mobile格式不正确</span><span>&quot;</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                    </span><span style="color:#b48ead;">return</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                List&lt;</span><span style="color:#b48ead;">string</span><span style="color:#eff1f5;">&gt; </span><span style="color:#bf616a;">friends </span><span>= new </span><span style="color:#eff1f5;">List&lt;</span><span style="color:#b48ead;">string</span><span style="color:#eff1f5;">&gt;();
</span><span style="color:#eff1f5;">                </span><span style="color:#bf616a;">friends</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Add</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">Mobile</span><span style="color:#eff1f5;">);</span><span style="color:#65737e;">//发送到自己
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">if </span><span style="color:#eff1f5;">(</span><span>!</span><span style="color:#b48ead;">string</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">IsNullOrEmpty</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">Recipients</span><span style="color:#eff1f5;">))
</span><span style="color:#eff1f5;">                {
</span><span style="color:#eff1f5;">                    </span><span style="color:#b48ead;">var </span><span style="color:#bf616a;">parts </span><span>= </span><span style="color:#bf616a;">Recipients</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Split</span><span style="color:#eff1f5;">(</span><span>new </span><span style="color:#b48ead;">char</span><span style="color:#eff1f5;">[] { </span><span style="color:#d08770;">&#39;;&#39; </span><span style="color:#eff1f5;">}, </span><span style="color:#bf616a;">StringSplitOptions</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">RemoveEmptyEntries</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                    </span><span style="color:#b48ead;">if </span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">parts</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Length </span><span>!= </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">                    {
</span><span style="color:#eff1f5;">                        </span><span style="color:#b48ead;">var </span><span style="color:#bf616a;">items </span><span>= </span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">from </span><span style="color:#bf616a;">fetionId </span><span style="color:#b48ead;">in </span><span style="color:#bf616a;">parts
</span><span style="color:#eff1f5;">                                     </span><span style="color:#b48ead;">select </span><span style="color:#bf616a;">fetionId</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Trim</span><span style="color:#eff1f5;">()).</span><span style="color:#bf616a;">ToArray</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">                        </span><span style="color:#bf616a;">friends</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">AddRange</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">items</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                    }
</span><span style="color:#eff1f5;">                }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#bf616a;">Send</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">message</span><span style="color:#eff1f5;">, </span><span style="color:#bf616a;">friends</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Distinct</span><span style="color:#eff1f5;">().</span><span style="color:#bf616a;">ToArray</span><span style="color:#eff1f5;">());
</span><span style="color:#eff1f5;">            }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            </span><span style="color:#65737e;">/// &lt;</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// 群发
</span><span style="color:#65737e;">            /// &lt;/</span><span style="color:#bf616a;">summary</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// &lt;</span><span style="color:#bf616a;">param </span><span style="color:#d08770;">name</span><span style="color:#65737e;">=</span><span style="color:#a3be8c;">&quot;message&quot;</span><span style="color:#65737e;">&gt;&lt;/</span><span style="color:#bf616a;">param</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// &lt;</span><span style="color:#bf616a;">param </span><span style="color:#d08770;">name</span><span style="color:#65737e;">=</span><span style="color:#a3be8c;">&quot;friends&quot;</span><span style="color:#65737e;">&gt;&lt;/</span><span style="color:#bf616a;">param</span><span style="color:#65737e;">&gt;
</span><span style="color:#65737e;">            /// &lt;</span><span style="color:#bf616a;">returns</span><span style="color:#65737e;">&gt;&lt;/</span><span style="color:#bf616a;">returns</span><span style="color:#65737e;">&gt;
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">private void </span><span style="color:#8fa1b3;">Send</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">string </span><span style="color:#bf616a;">message</span><span style="color:#eff1f5;">, </span><span style="color:#b48ead;">string</span><span style="color:#eff1f5;">[] </span><span style="color:#bf616a;">friends</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">            {
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">int </span><span style="color:#bf616a;">timeOut </span><span>= </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">if </span><span style="color:#eff1f5;">(</span><span>!</span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">TryParse</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">Timeout</span><span style="color:#eff1f5;">, </span><span style="color:#b48ead;">out </span><span style="color:#bf616a;">timeOut</span><span style="color:#eff1f5;">) </span><span>|| </span><span style="color:#bf616a;">timeOut </span><span>&lt;= </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">                {
</span><span style="color:#eff1f5;">                    </span><span style="color:#bf616a;">timeOut </span><span>= </span><span style="color:#d08770;">3000</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">string </span><span style="color:#bf616a;">uuid </span><span>= </span><span style="color:#bf616a;">Guid</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">NewGuid</span><span style="color:#eff1f5;">().</span><span style="color:#bf616a;">ToString</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                JsonSerializer </span><span style="color:#bf616a;">serializer </span><span>= new </span><span style="color:#eff1f5;">JsonSerializer();
</span><span style="color:#eff1f5;">                StringWriter </span><span style="color:#bf616a;">swriter </span><span>= new </span><span style="color:#eff1f5;">StringWriter();
</span><span style="color:#eff1f5;">                </span><span style="color:#bf616a;">serializer</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Serialize</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">swriter</span><span style="color:#eff1f5;">, </span><span style="color:#bf616a;">friends</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">string </span><span style="color:#bf616a;">friendUri </span><span>= </span><span style="color:#bf616a;">swriter</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">ToString</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">string </span><span style="color:#bf616a;">content </span><span>= &quot;</span><span style="color:#a3be8c;">mobile=</span><span>&quot; + </span><span style="color:#bf616a;">Mobile </span><span>+ &quot;</span><span style="color:#a3be8c;">&amp;uuid=</span><span>&quot; + </span><span style="color:#bf616a;">uuid
</span><span style="color:#eff1f5;">                                 </span><span>+ &quot;</span><span style="color:#a3be8c;">&amp;password=</span><span>&quot; + </span><span style="color:#bf616a;">Password </span><span>+ &quot;</span><span style="color:#a3be8c;">&amp;friend=</span><span>&quot; + </span><span style="color:#bf616a;">friendUri
</span><span style="color:#eff1f5;">                                 </span><span>+ &quot;</span><span style="color:#a3be8c;">&amp;message=</span><span>&quot; + </span><span style="color:#bf616a;">HttpUtility</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">UrlEncode</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">message</span><span style="color:#eff1f5;">, </span><span style="color:#bf616a;">Encoding</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">UTF8</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">var </span><span style="color:#bf616a;">request </span><span>= </span><span style="color:#bf616a;">HttpWebRequest</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Create</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">string</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Format</span><span style="color:#eff1f5;">(</span><span>&quot;</span><span style="color:#d08770;">{0}</span><span style="color:#a3be8c;">/restlet/fetion</span><span>&quot;</span><span style="color:#eff1f5;">, </span><span style="color:#bf616a;">BaseAddress</span><span style="color:#eff1f5;">));
</span><span style="color:#eff1f5;">                </span><span style="color:#bf616a;">request</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Method </span><span>= &quot;</span><span style="color:#a3be8c;">POST</span><span>&quot;</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                </span><span style="color:#bf616a;">request</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">CachePolicy </span><span>= new </span><span style="color:#eff1f5;">RequestCachePolicy(</span><span style="color:#bf616a;">RequestCacheLevel</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">NoCacheNoStore</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                </span><span style="color:#bf616a;">request</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">ContentType </span><span>= &quot;</span><span style="color:#a3be8c;">application/x-www-form-urlencoded</span><span>&quot;</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                </span><span style="color:#bf616a;">request</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Timeout </span><span>= </span><span style="color:#bf616a;">timeOut</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">var </span><span style="color:#bf616a;">buffer </span><span>= </span><span style="color:#bf616a;">Encoding</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">ASCII</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">GetBytes</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">content</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">int </span><span style="color:#bf616a;">bufferSize </span><span>= </span><span style="color:#d08770;">1024</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">int </span><span style="color:#bf616a;">offset </span><span>= </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">int </span><span style="color:#bf616a;">count </span><span>= </span><span style="color:#bf616a;">buffer</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Length </span><span>&gt; </span><span style="color:#bf616a;">bufferSize </span><span>? </span><span style="color:#d08770;">1024 </span><span>: </span><span style="color:#bf616a;">buffer</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Length</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                AsyncCallback </span><span style="color:#bf616a;">responseCallback </span><span>= </span><span style="color:#b48ead;">delegate</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">IAsyncResult ar</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">                {
</span><span style="color:#eff1f5;">                    </span><span style="color:#bf616a;">var response </span><span>= </span><span style="color:#eff1f5;">(HttpWebResponse)</span><span style="color:#bf616a;">request</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">EndGetResponse</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">ar</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                    </span><span style="color:#b48ead;">if </span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">response</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">StatusCode </span><span>== </span><span style="color:#bf616a;">HttpStatusCode</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Accepted</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">                    {
</span><span style="color:#eff1f5;">                        </span><span style="color:#65737e;">//success
</span><span style="color:#eff1f5;">                        </span><span style="color:#bf616a;">Console</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">WriteLine</span><span style="color:#eff1f5;">(</span><span>&quot;</span><span style="color:#a3be8c;">发送成功</span><span>&quot;</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                    }
</span><span style="color:#eff1f5;">                    </span><span style="color:#b48ead;">else
</span><span style="color:#eff1f5;">                    {
</span><span style="color:#eff1f5;">                        </span><span style="color:#65737e;">//fail
</span><span style="color:#eff1f5;">                        </span><span style="color:#bf616a;">Console</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">WriteLine</span><span style="color:#eff1f5;">(</span><span>&quot;</span><span style="color:#a3be8c;">发送失败</span><span>&quot;</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                    }
</span><span style="color:#eff1f5;">                };
</span><span style="color:#eff1f5;">                AsyncCallback </span><span style="color:#bf616a;">writeCallBack </span><span>= </span><span style="color:#d08770;">null</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                </span><span style="color:#bf616a;">writeCallBack </span><span>= </span><span style="color:#b48ead;">delegate</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">IAsyncResult ar</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">                {
</span><span style="color:#eff1f5;">                    </span><span style="color:#b48ead;">var </span><span style="color:#bf616a;">requestStream </span><span>= </span><span style="color:#eff1f5;">(Stream)</span><span style="color:#bf616a;">ar</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">AsyncState</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                    </span><span style="color:#b48ead;">try
</span><span style="color:#eff1f5;">                    {
</span><span style="color:#eff1f5;">                        </span><span style="color:#bf616a;">requestStream</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">EndWrite</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">ar</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                        </span><span style="color:#bf616a;">offset </span><span>+= </span><span style="color:#bf616a;">count</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                        </span><span style="color:#b48ead;">int </span><span style="color:#bf616a;">left </span><span>= </span><span style="color:#bf616a;">buffer</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Length </span><span>- </span><span style="color:#bf616a;">offset</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                        </span><span style="color:#b48ead;">if </span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">left </span><span>&gt; </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">                        {
</span><span style="color:#eff1f5;">                            </span><span style="color:#bf616a;">count </span><span>= </span><span style="color:#bf616a;">left </span><span>&gt; </span><span style="color:#bf616a;">bufferSize </span><span>? </span><span style="color:#bf616a;">bufferSize </span><span>: </span><span style="color:#bf616a;">left</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                            </span><span style="color:#bf616a;">requestStream</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">BeginWrite</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">buffer</span><span style="color:#eff1f5;">, </span><span style="color:#bf616a;">offset</span><span style="color:#eff1f5;">, </span><span style="color:#bf616a;">count</span><span style="color:#eff1f5;">,
</span><span style="color:#eff1f5;">                                                     </span><span style="color:#bf616a;">writeCallBack</span><span style="color:#eff1f5;">,
</span><span style="color:#eff1f5;">                                                     </span><span style="color:#bf616a;">requestStream</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                        }
</span><span style="color:#eff1f5;">                        </span><span style="color:#b48ead;">else
</span><span style="color:#eff1f5;">                        {
</span><span style="color:#eff1f5;">                            </span><span style="color:#bf616a;">request</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">BeginGetResponse</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">responseCallback</span><span style="color:#eff1f5;">, </span><span style="color:#d08770;">null</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                        }
</span><span style="color:#eff1f5;">                    }
</span><span style="color:#eff1f5;">                    </span><span style="color:#b48ead;">catch </span><span style="color:#eff1f5;">(Exception </span><span style="color:#bf616a;">ex</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">                    {
</span><span style="color:#eff1f5;">                        </span><span style="color:#65737e;">//fail
</span><span style="color:#eff1f5;">                        </span><span style="color:#bf616a;">Console</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">WriteLine</span><span style="color:#eff1f5;">(</span><span>&quot;</span><span style="color:#a3be8c;">fail:</span><span style="color:#d08770;">{0}</span><span>&quot;</span><span style="color:#eff1f5;">,</span><span style="color:#bf616a;">ex</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Message</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                    }
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                };
</span><span style="color:#eff1f5;">                AsyncCallback </span><span style="color:#bf616a;">requestCallBack </span><span>= </span><span style="color:#b48ead;">delegate</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">IAsyncResult ar</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">                {
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                    </span><span style="color:#bf616a;">var requestStream </span><span>= </span><span style="color:#bf616a;">request</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">EndGetRequestStream</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">ar</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                    </span><span style="color:#bf616a;">requestStream</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">BeginWrite</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">buffer</span><span style="color:#eff1f5;">, </span><span style="color:#bf616a;">offset</span><span style="color:#eff1f5;">, </span><span style="color:#bf616a;">count</span><span style="color:#eff1f5;">, </span><span style="color:#bf616a;">writeCallBack</span><span style="color:#eff1f5;">,
</span><span style="color:#eff1f5;">                                             </span><span style="color:#bf616a;">requestStream</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">                };
</span><span style="color:#eff1f5;">                </span><span style="color:#bf616a;">request</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">BeginGetRequestStream</span><span style="color:#eff1f5;">(</span><span style="color:#bf616a;">requestCallBack</span><span style="color:#eff1f5;">, </span><span style="color:#d08770;">null</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">
</span><span style="color:#eff1f5;">            }
</span><span style="color:#eff1f5;">        }
</span><span>    }
</span></code></pre>
<p>编译项目得到FetionLib.dll。</p>
<p>通过配置文件使用：</p>
<pre data-lang="xml" style="background-color:#2b303b;color:#c0c5ce;" class="language-xml "><code class="language-xml" data-lang="xml"><span>
</span><span>    &lt;?</span><span style="color:#bf616a;">xml </span><span style="color:#d08770;">version</span><span>=&quot;</span><span style="color:#a3be8c;">1.0</span><span>&quot;?&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">configuration</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">configSections</span><span>&gt;
</span><span>        &lt;</span><span style="color:#bf616a;">section </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">nlog</span><span>&quot; </span><span style="color:#d08770;">type</span><span>=&quot;</span><span style="color:#a3be8c;">NLog.Config.ConfigSectionHandler, NLog</span><span>&quot;/&gt;
</span><span>    &lt;/</span><span style="color:#bf616a;">configSections</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">nlog </span><span style="color:#d08770;">xmlns</span><span>=&quot;</span><span style="color:#a3be8c;">http://www.nlog-project.org/schemas/NLog.xsd</span><span>&quot; </span><span style="color:#d08770;">xmlns:xsi</span><span>=&quot;</span><span style="color:#a3be8c;">http://www.w3.org/2001/XMLSchema-instance</span><span>&quot;&gt;
</span><span>        &lt;</span><span style="color:#bf616a;">extensions</span><span>&gt;
</span><span>          &lt;</span><span style="color:#bf616a;">add </span><span style="color:#d08770;">assembly</span><span>=&quot;</span><span style="color:#a3be8c;">FetionLib</span><span>&quot;/&gt;
</span><span>        &lt;/</span><span style="color:#bf616a;">extensions</span><span>&gt;
</span><span>        &lt;</span><span style="color:#bf616a;">targets</span><span>&gt;
</span><span>          </span><span style="color:#65737e;">&lt;!--默认收信人为发信人，recipients收信人用;分隔多个--&gt;
</span><span>          &lt;</span><span style="color:#bf616a;">target </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">fetion</span><span>&quot; </span><span style="color:#d08770;">type</span><span>=&quot;</span><span style="color:#a3be8c;">Fetion</span><span>&quot;
</span><span>                  </span><span style="color:#d08770;">BaseAddress</span><span>=&quot;</span><span style="color:#a3be8c;">http://fetion.xinghuo.org.ru</span><span>&quot;
</span><span>                  </span><span style="color:#d08770;">mobile</span><span>=&quot;</span><span style="color:#a3be8c;">135*******</span><span>&quot; </span><span style="color:#d08770;">password</span><span>=&quot;</span><span style="color:#a3be8c;">******</span><span>&quot;
</span><span>                  </span><span style="color:#d08770;">layout</span><span>=&quot;</span><span style="color:#a3be8c;">${date:format=HH\:MM\:ss} ${message}</span><span>&quot;/&gt;
</span><span>          &lt;</span><span style="color:#bf616a;">target </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">console</span><span>&quot; </span><span style="color:#d08770;">xsi:type</span><span>=&quot;</span><span style="color:#a3be8c;">Console</span><span>&quot; </span><span style="color:#d08770;">layout</span><span>=&quot;</span><span style="color:#a3be8c;">${date:format=HH\:MM\:ss} ${logger} ${message}</span><span>&quot;/&gt;
</span><span>        &lt;/</span><span style="color:#bf616a;">targets</span><span>&gt;
</span><span>        &lt;</span><span style="color:#bf616a;">rules</span><span>&gt;
</span><span>          &lt;</span><span style="color:#bf616a;">logger </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">*</span><span>&quot; </span><span style="color:#d08770;">minLevel</span><span>=&quot;</span><span style="color:#a3be8c;">Info</span><span>&quot; </span><span style="color:#d08770;">appendTo</span><span>=&quot;</span><span style="color:#a3be8c;">fetion</span><span>&quot;/&gt;
</span><span>          &lt;</span><span style="color:#bf616a;">logger </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">*</span><span>&quot; </span><span style="color:#d08770;">minLevel</span><span>=&quot;</span><span style="color:#a3be8c;">Info</span><span>&quot; </span><span style="color:#d08770;">appendTo</span><span>=&quot;</span><span style="color:#a3be8c;">console</span><span>&quot;/&gt;
</span><span>        &lt;/</span><span style="color:#bf616a;">rules</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#bf616a;">nlog</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">startup</span><span>&gt;&lt;</span><span style="color:#bf616a;">supportedRuntime </span><span style="color:#d08770;">version</span><span>=&quot;</span><span style="color:#a3be8c;">v4.0</span><span>&quot; </span><span style="color:#d08770;">sku</span><span>=&quot;</span><span style="color:#a3be8c;">.NETFramework,Version=v4.0</span><span>&quot;/&gt;&lt;/</span><span style="color:#bf616a;">startup</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#bf616a;">configuration</span><span>&gt;
</span></code></pre>
<p>在控制台测试：</p>
<pre data-lang="c#" style="background-color:#2b303b;color:#c0c5ce;" class="language-c# "><code class="language-c#" data-lang="c#"><span>    </span><span style="color:#b48ead;">using </span><span>System;
</span><span>    </span><span style="color:#b48ead;">using </span><span>NLog;
</span><span>
</span><span>    </span><span style="color:#b48ead;">namespace </span><span>NLogTest
</span><span>    {
</span><span>        </span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">Program
</span><span style="color:#eff1f5;">        {
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">static void </span><span style="color:#8fa1b3;">Main</span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">string</span><span style="color:#eff1f5;">[] </span><span style="color:#bf616a;">args</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">            {
</span><span style="color:#eff1f5;">                Logger </span><span style="color:#bf616a;">logger </span><span>= </span><span style="color:#bf616a;">LogManager</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">GetCurrentClassLogger</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">                </span><span style="color:#bf616a;">logger</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">Error</span><span style="color:#eff1f5;">(</span><span>&quot;</span><span style="color:#a3be8c;">something is wrong!</span><span>&quot;</span><span style="color:#eff1f5;">);
</span><span style="color:#eff1f5;">                </span><span style="color:#bf616a;">Console</span><span style="color:#eff1f5;">.</span><span style="color:#bf616a;">ReadKey</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">            }
</span><span style="color:#eff1f5;">        }
</span><span>    }
</span></code></pre>
<p>启动运行后看到&quot;发送成功&quot;你就收到短信了。</p>
<h2 id="xiang-guan-zi-yuan">相关资源：</h2>
<p><a href="http://nlog-project.org/how-to-write-your-own-target.html">1.How To Write Your Own Target</a></p>
<p><a href="http://fetionlib.appspot.com/api.html">2.飞信接口API调用举例</a></p>
<hr />
<p>从我的百度空间导入</p>

    </div>

    
    

    <div class="post-footer">
        
        
        <div class="post-tags">
            
            <a href="https://blog.dotone.top/tags/net/">#.Net</a>
            
            <a href="https://blog.dotone.top/tags/c/">#c#</a>
            
            <a href="https://blog.dotone.top/tags/nlog/">#NLog</a>
            
        </div>
        
        

        
    </div>

    
    
    <section id="utterances-comments">
        <script src="https://utteranc.es/client.js" repo="Joylei/joylei.github.io" issue-term="pathname"
            theme="preferred-color-scheme" crossorigin="anonymous" async>
            </script>
    </section>
    
    
</article>


            </div>
        </main>

        
        
    </div>

    
    <script type="text/javascript" src="https://blog.dotone.top/even.js"></script>
    
</body>

</html>